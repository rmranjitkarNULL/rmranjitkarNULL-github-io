<!DOCTYPE HTML>
<html>
	<head>
		<title>VGA Output</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
		<div id="wrapper">

			<!-- Header -->
			<header id="header">
				<a href="../index.html" class="logo"><strong>Ryan</strong> <span>Ranjitkar</span></a>
				<nav><a href="#menu">Menu</a></nav>
			</header>

			<!-- Menu -->
			<nav id="menu">
				<ul class="links">
					<li><a href="../index.html">Home</a></li>
					<li><a href="../aboutme.html">About Me</a></li>
					<li><a href="projects.html">Projects</a></li>
				</ul>
			</nav>

			<!-- Main -->
			<div id="main" class="alt">
				<section id="one">
					<div class="inner">
						<header class="major">
							<h1>Light Sensor Interface on Basys3 Board</h1>
						</header>
						<p>
							This FPGA-based project implemented a complete light-sensing system on the Digilent Basys3 board using Verilog HDL. 
							The design interfaced the PMOD ALS (Analog Light Sensor) module—which contains an ADC081S021 SPI ADC—using a custom-built SPI master and finite state machine. 
							A 10 MHz clock generated by an MMCM drove all sequential logic, while sampled data was displayed in real time on a four-digit seven-segment display. 
							To verify correctness, a behavioral model (BFM) of the sensor and a Verilog testbench were written to simulate realistic SPI behavior, ensuring proper data capture timing and serial protocol compliance.
						</p>
					</div>
				</section>
			</div>

			<div id="main">
				<section id="two" class="spotlights">

					<!-- Section 1 -->
					<section>
						<img src="../assets/images/underConstruction.jpg" alt="" data-position="top center" />
						<div class="content">
							<div class="inner">
								<header class="major">
									<h3>System Architecture</h3>
								</header>
								<p>
									The top-level system integrated three key modules:
									<ul>
										<li><strong>Clock Generator (clk_gen):</strong> Used the Basys3 MMCM to derive a 10 MHz clock and synchronized the <code>locked</code> signal with a two-stage flip-flop to prevent metastability.</li>
										<li><strong>Sensor Interface (pmod_als):</strong> Implemented a 2.5 MHz SPI master and a four-state FSM controlling chip select, serial clock, and data capture once per second.</li>
										<li><strong>Seven-Segment Display Controller:</strong> Split the 8-bit light value into two hexadecimal nibbles, multiplexed four displays, and appended the last two digits of the WPI ID.</li>
									</ul>
									The SPI interface read 16-bit sensor frames, extracted bits [11:4] as light intensity data, and passed the value to the display controller for real-time visualization.
								</p>
							</div>
						</div>
					</section>

					<!-- Section 2 -->
					<section>
						<img src="../assets/images/underConstruction.jpg" alt="" data-position="top center" />
						<div class="content">
							<div class="inner">
								<header class="major">
									<h3>Module Development</h3>
								</header>
								<p>
									The <strong>sensor_i-'/.0;9l,5mn7j6h vg54fcnterface</strong> module communicated with the PMOD ALS using SPI protocol. A 24-bit counter set the 1 Hz sampling period, while a 15-bit shift register captured data on each falling edge of <code>SCLK</code>. 
									A finite-state machine handled the sequence: <em>IDLE → WAIT → READ → DONE</em>, ensuring chip-select timing and SPI alignment with a simulated 40 ns access delay (<em>T<sub>ACC</sub></em>). 
									Each module—clock, interface, and display—was individually verified in Vivado simulations before integration.
								</p>
								<p>
									<strong>Resource Utilization:</strong> 57 LUTs and 108 registers total, dominated by the SPI logic. All setup and hold constraints were met (WNS = 95 ns, TNS = 0).
								</p>
							</div>
						</div>
					</section>

					<!-- NEW Section: Testbench -->
					<section>
						<img src="../assets/images/underConstruction.jpg" alt="" data-position="top center" />
						<div class="content">
							<div class="inner">
								<header class="major">
									<h3>Testbench Development &amp; Verification</h3>
								</header>
								<p>
									To verify the SPI logic before hardware deployment, a dedicated <strong>Behavioral Functional Model (BFM)</strong> and testbench were developed in Verilog. 
									The BFM (<code>ALS_PMOD_BFM</code>) emulated the PMOD ALS sensor’s behavior, including its 15-bit data frame format (3 zero padding bits + 8-bit data + 4 trailing zeros) and a 40 ns data-access delay.
								</p>
								<p>
									The <strong>testbench (<code>test_ALS_PMOD_BFM</code>)</strong> instantiated the BFM and automatically generated all SPI timing signals. 
									A 1 MHz serial clock toggled every 500 ns, while <code>CS_N</code> was pulsed low to initiate transfers. 
									In each iteration, the testbench loaded a new 8-bit <code>data_in</code> pattern, multiplied by an incremental factor to simulate four distinct light-intensity cases. 
									On each falling edge of <code>SCLK</code>, the BFM shifted bits serially into <code>SDO</code>, and the testbench reconstructed the 15-bit output in <code>data_receive</code>.
								</p>
								<p>
									After all 16 bits were captured, bits [11:4] were extracted and compared to the expected value. 
									Pass/fail messaWPIges were printed to the console in the form:
									<code>PASS: Expected = %h, Received = %h at time = %t ps</code>. 
									All four iterations passed successfully, confirming correct SPI alignment, serial shifting, and timing behavior. 
									The simulation waveforms clearly demonstrated the 40 ns delay between <code>SCLK</code> falling edges and valid <code>SDO</code> output, validating the BFM model and the design’s robustness.
								</p>
							</div>
						</div>
					</section>

					<!-- Section 3 -->
					<section>
						<img src="../assets/images/underConstruction.jpg" alt="" data-position="top center" />
						<div class="content">	
							<div class="inner">
								<header class=WPI"major">
									<h3>Results &amp; Reflection</h3>
								</header>
								<p>
									The final FPGA implementation successfully integrated the clocking, SPI interface, and display modules into a cohesive real-time system. 
									The seven-segment display updated at 1 Hz without flicker, and SPI communication remained stable across all hardware trials. 
									This project deepened understanding of synchronous digital design, SPI protocols, MMCM clocking, and simulation-driven verification. 
									By developing both the functional module and a rigorous testbench, the design process mirrored industry-grade validation methods for embedded and FPGA-based sensor systems.
								</p>
							</div>
						</div>
					</section>
				</section>

				<!-- View All Projects -->
				<section id="three" class="view-all-centered">
					<div class="inner">
						<header class="major">
							<h2>View All Projects</h2>
						</header>
						<p>Go back and check out my other FPGA and embedded system projects!</p>
						<ul class="actions">
							<li><a href="projects.html" class="button next">View All</a></li>
							<li><a href="https://github.com/rmranjitkar" class="button">GitHub Repository</a></li>
						</ul>
					</div>
				</section>
			</div>

			<br>

			<!-- Contact -->
			<section class="split">
				<section>
					<div class="contact-method">
						<h3><span class="icon solid alt fa-envelope"></span> Email</h3>
						<a href="mailto:rmranjitkar@wpi.edu">rmranjitkar@wpi.edu</a>
					</div>
				</section>
				<section>
					<div class="contact-method">
						<h3><span class="icon brands alt fa-linkedin-in"></span> LinkedIn</h3>
						<a href="https://www.linkedin.com/in/ryanranjitkar/">https://www.linkedin.com/in/ryanranjitkar/</a>
					</div>
				</section>
				<section>
					<div class="contact-method">
						<h3><span class="icon brands alt fa-github"></span> GitHub</h3>
						<a href="https://github.com/rmranjitkar">https://github.com/rmranjitkar</a>
					</div>
				</section>
			</section>
		</div>

		<!-- Scripts -->
		<script src="../assets/js/jquery.min.js"></script>
		<script src="../assets/js/jquery.scrolly.min.js"></script>
		<script src="../assets/js/jquery.scrollex.min.js"></script>
		<script src="../assets/js/browser.min.js"></script>
		<script src="../assets/js/breakpoints.min.js"></script>
		<script src="../assets/js/util.js"></script>
		<script src="../assets/js/main.js"></script>

	</body>
</html>
